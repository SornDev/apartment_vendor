import{_ as T,u as C,m as D,k as h,r as b,o as a,c as n,b as s,d as l,q as f,i as r,e as p,w as m,v as A,l as F,F as u,h as y,g as S,n as x,t as _}from"./app-JtYbRyaD.js";import{C as G}from"./flatpickr-CkvweW_Y.js";const V={setup(){return{store:C()}},mixins:[D],name:"DmsAcc",data(){return{TranData:{data:[]},dmy:"d",date:h().format("YYYY-MM-DD")||"",Search:"",config:{wrap:!0,altFormat:"d/m/Y",altInput:!0,dateFormat:"Y-m-d",allowInput:!1},FormTranAcc:{acc_type_id:"",tran_date:h().format("YYYY-MM-DD"),price:0,PayBy:0},AccTData:[],AccTName:"",ShowAcc:!1}},mounted(){},computed:{CheckFormAcc(){return this.FormTranAcc.acc_type_id==""||this.FormTranAcc.price==0}},components:{flatPickr:G,moment:h},methods:{AddTran(){var c=new bootstrap.Modal(document.getElementById("acc_form"),{keyboard:!1});c.show(),this.FormTranAcc.PayBy=0,this.FormTranAcc.price=0,this.AccTData.length>0&&(this.FormTranAcc.acc_type_id=this.AccTData[0].id)},SaveTran(){this.AddData("acc/add",this.FormTranAcc,c=>{c.success&&(this.GetTran(1),this.$refs.close_acc_form.click())})},MgAcc(){var c=new bootstrap.Modal(document.getElementById("acc_mg"),{keyboard:!1});c.show()},date_change(c){return h(c).format("DD/MM/YYYY")},GetTran(c){this.GetData(`acc/get?page=${c}&dmy=${this.dmy}&date=${this.date}&search=${this.Search}&per_page=${this.PerPage}`,e=>{this.TranData=e})},ShowFromAt(){this.ShowAcc=!0,this.AccTName="",setTimeout(()=>{this.$refs.ref_acc_name.focus()},800)},HideFromAt(){this.ShowAcc=!1},GetAcc(){this.GetData("acc_type/get",c=>{this.AccTData=c})},EditAcc(c){this.FormType=!1,this.GetData(`acc_type/edit/${c}`,e=>{this.AccTName=e.acc_type_name,this.ShowAcc=!0,this.EditID=c,setTimeout(()=>{this.$refs.ref_acc_name.focus()},800)})},SaveAccType(){this.FormType?this.AddData("acc_type/add",{acc_type_name:this.AccTName},c=>{c.success&&(this.GetAcc(),this.ShowAcc=!1)}):this.UpdateData(`acc_type/update/${this.EditID}`,{acc_type_name:this.AccTName},c=>{c.success&&(this.GetAcc(),this.ShowAcc=!1)})},DelAcc(c){this.DeleteData("acc_type/delete",c,e=>{e.success&&this.GetAcc()})},RejectTran(c){this.DeleteData("acc/delete",c,e=>{this.GetTran(1)},"ທີ່ຈະຍົກເລີກການລົງບັນຊີ!")}},created(){this.GetTran(1),this.GetAcc()},watch:{date(){this.GetTran(1)},dmy(){this.GetTran(1)},Search:function(c){c==""&&this.GetTran(1)}}},N={class:"card"},M={class:"card-header d-flex"},Y=s("h5",{class:"mb-0"},"ລາຍການທຸລະກຳ ບັນຊີ",-1),j={key:0,class:"spinner-grow spinner-grow-sm text-warning ms-2",role:"status"},B=s("span",{class:"visually-hidden"},"Loading...",-1),E=[B],P={class:"card-body"},U={class:"table-responsive text-nowrap"},J={class:"d-flex justify-content-between mb-2"},I={class:"input-group",style:{width:"240px"}},O={class:"input-group-text",id:"basic-addon11"},R={key:0,class:"bx bx-chevron-right"},L={key:0,class:"bx bx-chevron-right"},z={key:0,class:"bx bx-chevron-right"},H={class:"d-flex"},K={key:0,class:"btn-group"},q=s("button",{type:"button",class:"btn btn-primary dropdown-toggle","data-bs-toggle":"dropdown","aria-expanded":"false"},"ລົງບັນຊີ",-1),Q={class:"dropdown-menu",style:{}},W={key:0},X=s("i",{class:"bx bx-transfer-alt fs-5 me-2"},null,-1),Z={key:1},$=s("i",{class:"bx bx-customize me-2"},null,-1),ss={class:"table table-bordered shadow-sm"},ts={class:"table-info"},es=s("th",{class:"fs-6 fw-bold text-center",colspan:"2"},"ສະຖານະ",-1),os=s("th",{class:"fs-6 fw-bold"},"ເລກທີທຸລະກຳ",-1),cs=s("th",{class:"fs-6 fw-bold"},"ວັນທີ່",-1),as=s("th",{class:"fs-6 fw-bold"},"ລາຍລະອຽດ",-1),ns=s("th",{class:"fs-6 fw-bold"},"ຈຳນວນເງິນ",-1),ds=s("th",{class:"fs-6 fw-bold"},"ຈ່າຍໂດຍ",-1),is=s("th",{class:"fs-6 fw-bold"},"ຜູ້ລົງບັນຊີ",-1),ls={key:0,class:"fs-6 fw-bold"},rs={key:0},_s={class:"p-1 text-center"},ms={key:0,class:"bx bxs-check-shield text-success fs-4"},hs={key:1,class:"bx bxs-shield-x text-danger fs-4"},ps={class:"p-1 text-center"},us={key:0,class:"bx bxs-left-arrow-alt fs-3 text-success"},bs={key:1,class:"bx bxs-right-arrow-alt fs-3 text-danger"},fs={class:"text-end"},ys={key:0},vs={key:1},gs={key:0,class:"text-center"},As={class:"dropdown"},xs=s("button",{type:"button",class:"btn p-0 dropdown-toggle hide-arrow","data-bs-toggle":"dropdown"},[s("i",{class:"bx bx-dots-vertical-rounded"})],-1),ks={class:"dropdown-menu"},ws=["onClick"],Ts=s("i",{class:"bx bxs-eject me-1"},null,-1),Cs={key:1},Ds=s("tr",null,[s("td",{colspan:"9",class:"text-center"},[s("i",{class:"bx bxs-data me-1"}),r(" ບໍ່ມີຂໍ້ມູນ ")])],-1),Fs=[Ds],Ss={class:"modal modal-top modal-md fade",id:"acc_form",tabindex:"-1",style:{display:"none"},"data-bs-backdrop":"static","aria-hidden":"true"},Gs={class:"modal-dialog"},Vs={class:"modal-content"},Ns={class:"modal-header"},Ms=s("h5",{class:"modal-title",id:"modalTopTitle"},"ລົງບັນຊີລາຍຈ່າຍ",-1),Ys={type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",ref:"close_acc_form"},js={class:"modal-body pt-0"},Bs={class:"row"},Es={class:"col-6 mb-2"},Ps=s("label",{for:"tran_id",class:"form-label fs-6"},"ປະເພດລາຍຈ່າຍ",-1),Us=["value"],Js={class:"col-6 mb-2"},Is=s("label",{for:"tran_date",class:"form-label fs-6"},"ວັນທີ່ລົງທຸລະກຳ",-1),Os={class:"col-6 mb-2"},Rs=s("label",{for:"price",class:"form-label fs-6"},"ຈຳນວນເງິນ",-1),Ls={class:"input-group"},zs=s("span",{class:"input-group-text"},"₭",-1),Hs={class:"col-6 mb-2"},Ks=s("label",{for:"",class:"fs-6"},"ຊຳລະໂດຍ",-1),qs={class:"d-flex justify-content-between mt-2"},Qs={class:"me-4"},Ws={class:"form-check"},Xs=s("label",{class:"form-check-label",for:"formCheck1"}," ເງິນສົດ ",-1),Zs={class:"form-check"},$s=s("label",{class:"form-check-label",for:"formCheck2"}," ເງິນໂອນ ",-1),st={class:"d-flex justify-content-end mt-4"},tt=["disabled"],et={key:0},ot={key:1,class:"spinner-border text-warning",role:"status"},ct=s("span",{class:"visually-hidden"},"Loading...",-1),at=[ct],nt=s("button",{type:"button",class:"btn btn-label-secondary","data-bs-dismiss":"modal"}," ຍົກເລີກ ",-1),dt={class:"modal modal-top modal-md fade",id:"acc_mg",tabindex:"-1",style:{display:"none"},"data-bs-backdrop":"static","aria-hidden":"true"},it={class:"modal-dialog"},lt={class:"modal-content"},rt={class:"modal-header"},_t=s("h5",{class:"modal-title",id:"modalTopTitle"},"ປະເພດລາຍຈ່າຍ",-1),mt={type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",ref:"close_acc_mg"},ht={class:"modal-body pt-0"},pt={key:0,class:"row"},ut={class:"col-12"},bt={class:"mb-3 mt-3"},ft={class:"d-flex justify-content-end"},yt=["disabled"],vt={key:0},gt={key:1,class:"spinner-border text-warning",role:"status"},At=s("span",{class:"visually-hidden"},"Loading...",-1),xt=[At],kt={key:1,class:"row"},wt={class:"col-12"},Tt={class:"d-flex justify-content-end mb-2"},Ct={class:"table-responsive text-nowrap"},Dt={class:"table border shadow-sm"},Ft=s("thead",null,[s("tr",{class:"bg-info"},[s("th",{class:"fs-6 text-white fw-bold"},"ຊື່ປະເພດລາຍຈ່າຍ"),s("th",{class:"fs-6 text-center text-white fw-bold",width:"120"},"ຈັດການ")])],-1),St={class:"table-border-bottom-0"},Gt={class:"text-center"},Vt={class:"dropdown"},Nt=s("button",{type:"button",class:"btn p-0 dropdown-toggle hide-arrow","data-bs-toggle":"dropdown"},[s("i",{class:"bx bx-dots-vertical-rounded"})],-1),Mt={class:"dropdown-menu"},Yt=["onClick"],jt=s("i",{class:"bx bx-edit-alt me-2"},null,-1),Bt=["onClick"],Et=s("i",{class:"bx bx-trash me-2"},null,-1);function Pt(c,e,Ut,i,o,d){const v=b("flat-pickr"),k=b("pagination"),w=b("cleave");return a(),n(u,null,[s("div",N,[s("div",M,[Y,c.loading_table?(a(),n("div",j,E)):l("",!0)]),s("div",P,[s("div",U,[s("div",J,[s("div",I,[s("span",O,[s("span",{class:f(["me-2 cursor-pointer",o.dmy=="d"?"text-success":""]),onClick:e[0]||(e[0]=t=>o.dmy="d")},[o.dmy=="d"?(a(),n("i",R)):l("",!0),r("ວັນ ")],2),s("span",{class:f(["me-2 cursor-pointer",o.dmy=="m"?"text-success":""]),onClick:e[1]||(e[1]=t=>o.dmy="m")},[o.dmy=="m"?(a(),n("i",L)):l("",!0),r(" ເດືອນ ")],2),s("span",{class:f(["me-2 cursor-pointer",o.dmy=="y"?"text-success":""]),onClick:e[2]||(e[2]=t=>o.dmy="y")},[o.dmy=="y"?(a(),n("i",z)):l("",!0),r(" ປີ ")],2)]),p(v,{modelValue:o.date,"onUpdate:modelValue":e[3]||(e[3]=t=>o.date=t),config:o.config,class:"form-control",placeholder:"ວັນທີ່"},null,8,["modelValue","config"])]),s("div",H,[m(s("input",{type:"text",class:"form-control me-2","onUpdate:modelValue":e[4]||(e[4]=t=>o.Search=t),onKeyup:e[5]||(e[5]=F(t=>d.GetTran(1),["enter"])),placeholder:"ຄົ້ນຫາ..."},null,544),[[A,o.Search]]),i.store.get_permissions.includes("ACC_ACC_ADD")||i.store.get_permissions.includes("ACC_ACC_MG")||JSON.parse(i.store.get_user).user_type=="admin"?(a(),n("div",K,[q,s("ul",Q,[i.store.get_permissions.includes("ACC_ACC_ADD")||JSON.parse(i.store.get_user).user_type=="admin"?(a(),n("li",W,[s("a",{class:"dropdown-item",onClick:e[6]||(e[6]=t=>d.AddTran()),href:"javascript:void(0);"},[X,r(" ລົງບັນຊີ")])])):l("",!0),i.store.get_permissions.includes("ACC_ACC_MG")||JSON.parse(i.store.get_user).user_type=="admin"?(a(),n("li",Z,[s("a",{class:"dropdown-item",onClick:e[7]||(e[7]=t=>d.MgAcc()),href:"javascript:void(0);"},[$,r(" ປະເພດລາຍຈ່າຍ")])])):l("",!0)])])):l("",!0)])]),s("table",ss,[s("thead",null,[s("tr",ts,[es,os,cs,as,ns,ds,is,i.store.get_permissions.includes("ACC_REJECT")||JSON.parse(i.store.get_user).user_type=="admin"?(a(),n("th",ls,"ຈັດການ")):l("",!0)])]),o.TranData.data.length>0?(a(),n("tbody",rs,[(a(!0),n(u,null,y(o.TranData.data,t=>(a(),n("tr",{key:t},[s("td",_s,[t.status=="success"?(a(),n("i",ms)):(a(),n("i",hs))]),s("td",ps,[t.tran_type=="income"?(a(),n("i",us)):(a(),n("i",bs))]),s("td",null,_(t.tran_id),1),s("td",null,_(d.date_change(t.tran_date)),1),s("td",null,_(t.tran_details),1),s("td",fs,_(c.formatPrice(t.price))+" ₭",1),s("td",null,[t.bank_id=="bank"?(a(),n("span",ys,"ເງິນໂອນ")):(a(),n("span",vs,"ເງິນສົດ"))]),s("td",null,_(t.user_name),1),i.store.get_permissions.includes("ACC_REJECT")||JSON.parse(i.store.get_user).user_type=="admin"?(a(),n("td",gs,[s("div",As,[xs,s("div",ks,[s("a",{class:"dropdown-item text-danger",onClick:g=>d.RejectTran(t.id),href:"javascript:void(0);"},[Ts,r(" ຍົກເລີກ")],8,ws)])])])):l("",!0)]))),128))])):(a(),n("tbody",Cs,Fs))]),p(k,{pagination:o.TranData,onPaginate:e[8]||(e[8]=t=>d.GetTran(t)),offset:4},null,8,["pagination"])])])]),s("div",Ss,[s("div",Gs,[s("div",Vs,[s("div",Ns,[Ms,s("button",Ys,null,512)]),s("div",js,[s("div",Bs,[s("div",Es,[Ps,m(s("select",{class:"form-select","onUpdate:modelValue":e[9]||(e[9]=t=>o.FormTranAcc.acc_type_id=t)},[(a(!0),n(u,null,y(o.AccTData,t=>(a(),n("option",{value:t.id,key:t.id},_(t.acc_type_name),9,Us))),128))],512),[[S,o.FormTranAcc.acc_type_id]])]),s("div",Js,[Is,p(v,{modelValue:o.FormTranAcc.tran_date,"onUpdate:modelValue":e[10]||(e[10]=t=>o.FormTranAcc.tran_date=t),config:o.config,class:"form-control",placeholder:"ວັນທີ່"},null,8,["modelValue","config"])]),s("div",Os,[Rs,s("div",Ls,[p(w,{options:c.options,class:"form-control text-end",modelValue:o.FormTranAcc.price,"onUpdate:modelValue":e[11]||(e[11]=t=>o.FormTranAcc.price=t),id:"price",placeholder:"..."},null,8,["options","modelValue"]),zs])]),s("div",Hs,[Ks,s("div",qs,[s("span",Qs,[s("div",Ws,[m(s("input",{class:"form-check-input",type:"radio",id:"formCheck1",name:"payby",value:0,"onUpdate:modelValue":e[12]||(e[12]=t=>o.FormTranAcc.PayBy=t)},null,512),[[x,o.FormTranAcc.PayBy]]),Xs])]),s("span",null,[s("div",Zs,[m(s("input",{class:"form-check-input",type:"radio",name:"payby",id:"formCheck2",value:"bank","onUpdate:modelValue":e[13]||(e[13]=t=>o.FormTranAcc.PayBy=t)},null,512),[[x,o.FormTranAcc.PayBy]]),$s])])])])]),s("div",st,[s("button",{type:"button",class:"btn btn-primary me-2",disabled:d.CheckFormAcc,onClick:e[14]||(e[14]=t=>d.SaveTran())},[c.loading_post?(a(),n("div",ot,at)):(a(),n("span",et,"ບັນທຶກ"))],8,tt),nt])])])])]),s("div",dt,[s("div",it,[s("div",lt,[s("div",rt,[_t,s("button",mt,null,512)]),s("div",ht,[o.ShowAcc?(a(),n("div",pt,[s("div",ut,[s("div",bt,[m(s("input",{type:"text",ref:"ref_acc_name","onUpdate:modelValue":e[15]||(e[15]=t=>o.AccTName=t),class:"form-control",id:"acc_name",placeholder:"..."},null,512),[[A,o.AccTName]])]),s("div",ft,[s("button",{type:"button",class:"btn btn-primary me-2",disabled:!o.AccTName,onClick:e[16]||(e[16]=t=>d.SaveAccType())},[c.loading_post?(a(),n("div",gt,xt)):(a(),n("span",vt,"ບັນທຶກ"))],8,yt),s("button",{type:"button",class:"btn btn-label-secondary",onClick:e[17]||(e[17]=t=>d.HideFromAt())}," ຍົກເລີກ ")])])])):(a(),n("div",kt,[s("div",wt,[s("div",Tt,[s("button",{type:"button",class:"btn btn-primary",onClick:e[18]||(e[18]=t=>d.ShowFromAt())}," ເພີ່ມໃໝ່ ")]),s("div",Ct,[s("table",Dt,[Ft,s("tbody",St,[(a(!0),n(u,null,y(o.AccTData,t=>(a(),n("tr",{key:t.id},[s("td",null,_(t.acc_type_name),1),s("td",Gt,[s("div",Vt,[Nt,s("div",Mt,[s("a",{class:"dropdown-item",href:"javascript:void(0);",onClick:g=>d.EditAcc(t.id)},[jt,r(" ແກ້ໄຂ")],8,Yt),s("a",{class:"dropdown-item",href:"javascript:void(0);",onClick:g=>d.DelAcc(t.id)},[Et,r(" ລຶບ")],8,Bt)])])])]))),128))])])])])]))])])])])],64)}const Ot=T(V,[["render",Pt]]);export{Ot as default};
