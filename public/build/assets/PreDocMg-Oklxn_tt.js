import{m as C}from"./ulmixins-3GuYya29.js";import{_ as x,u as w,o,c as i,a as s,w as u,h as g,j as k,f as p,e as f,F as b,r as S,t as D,b as m,g as y,p as $,q as F}from"./app-R5zms-zh.js";const G={setup(){return{store:w()}},mixins:[C],name:"DmsCateDoc",emits:["catid"],data(){return{doc_cat_name:{name:"",price:0},doc_cat_id:"",DocCatData:{data:[]}}},computed:{check_bt(){return this.doc_cat_name.name==""?!0:!!this.loading_post}},mounted(){},methods:{sent_id(t){this.doc_cat_id=t,this.$emit("catid",t)},AddDocCat(){this.FormType=!0,this.doc_cat_name.name="",this.doc_cat_name.price=0;var t=new bootstrap.Modal(document.getElementById("doc_cat"),{keyboard:!1});t.show()},SaveDocCat(){this.FormType?this.AddData("doccat/add",this.doc_cat_name,t=>{t.success&&(this.$refs.close_doc_cat.click(),this.GetDocCat())}):this.UpdateData("doccat/update/"+this.EditID,this.doc_cat_name,t=>{this.$refs.close_doc_cat.click(),this.GetDocCat()})},EditDocCat(t){this.FormType=!1,this.GetData("doccat/edit/"+t,e=>{this.doc_cat_name=e,this.EditID=t;var _=new bootstrap.Modal(document.getElementById("doc_cat"),{keyboard:!1});_.show()})},DeleteDocCat(t){this.DeleteData("doccat/delete",t,e=>{e.success&&this.GetDocCat()})},GetDocCat(t){this.GetData(`doccat?page=${t}&perpage=${this.PerPage}&short=${this.Sort}&search=${this.Search}`,e=>{this.DocCatData=e,this.doc_cat_id==""&&this.DocCatData.data.length>0&&(this.doc_cat_id=this.DocCatData.data[0].id,this.$emit("catid",this.doc_cat_id))})}},created(){this.GetDocCat()},watch:{Search(){this.Search==""&&this.GetDocCat()}}},E={class:"card"},I={class:"d-flex justify-content-between p-3"},O={class:"text-wrap"},A=s("i",{class:"bx bx-plus fs-4"},null,-1),M=[A],j={class:"table-responsive text-nowrap"},T={class:"table"},N={class:"ms-4 me-4"},L={class:"border table-info"},V=s("th",{class:"fs-6 fw-bold"},"ຊື່ປະເພດເອກະສານ",-1),U=s("th",{class:"fs-6 fw-bold",width:"150"},"ລາຄາບໍລິການ",-1),J={key:0,class:"fs-6 fw-bold text-center",width:"100"},B=s("th",{class:"p-0",width:"45"},null,-1),P={key:0},R={key:0},K=s("td",{colspan:"2",class:"text-center"},[s("div",{class:"spinner-border text-warning",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")])],-1),q=[K],z=["onClick"],H={class:"text-end"},Q={key:0,class:"text-center"},W={class:"dropdown"},X=s("button",{type:"button",class:"btn p-0 dropdown-toggle hide-arrow","data-bs-toggle":"dropdown"},[s("i",{class:"bx bx-dots-vertical-rounded"})],-1),Y={class:"dropdown-menu"},Z=["onClick"],ss=s("i",{class:"bx bx-edit-alt me-1"},null,-1),es=["onClick"],ts=s("i",{class:"bx bx-trash me-1"},null,-1),os={class:"p-0"},is={class:"d-flex align-items-center justify-content-center"},ns={key:0,class:"bx bxs-right-arrow-circle fs-4 text-warning"},ds={key:1},cs=s("tr",null,[s("td",{colspan:"3",class:"text-center"},[s("i",{class:"bx bxs-data me-1"}),m(" ບໍ່ມີຂໍ້ມູນ ")])],-1),as=[cs],ls={class:"modal modal-top fade","data-bs-backdrop":"static",id:"doc_cat",tabindex:"-1",style:{display:"none"},"aria-hidden":"true"},rs={class:"modal-dialog"},_s={class:"modal-content"},ps={class:"modal-header"},ms={type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",ref:"close_doc_cat"},hs={class:"modal-body pt-0"},us={class:"row"},gs={class:"col-12 mb-3"},fs=s("label",{class:"form-label fs-6"},[m("ຊື່ປະເພດເອກະສານ: "),s("span",{class:"text-danger"},"*")],-1),bs={class:"col-6 mb-3"},Ds=s("label",{class:"form-label fs-6"},"ລາຄາບໍລິການ: ",-1),ys={class:"input-group"},xs=s("span",{class:"input-group-text cursor-pointer"}," ກີບ ",-1),vs={class:"d-flex justify-content-end"},Cs=["disabled"],ws={key:0},ks={key:1,class:"spinner-border text-warning",role:"status"},Ss=s("span",{class:"visually-hidden"},"Loading...",-1),$s=[Ss],Fs=s("button",{type:"button",class:"btn btn-label-secondary","data-bs-dismiss":"modal"},"ຍົກເລີກ",-1);function Gs(t,e,_,d,a,c){const n=y("pagination"),h=y("cleave");return o(),i(b,null,[s("div",E,[s("div",I,[s("div",O,[u(s("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=r=>t.Search=r),onKeyup:e[1]||(e[1]=k(r=>c.GetDocCat(),["enter"])),class:"form-control",placeholder:"ຄົ້ນຫາ..."},null,544),[[g,t.Search]])]),d.store.get_permissions.includes("DOCMG_ACC_EDIT")||JSON.parse(d.store.get_user).user_type=="admin"?(o(),i("button",{key:0,type:"button",class:"btn rounded-pill btn-icon btn-info",onClick:e[2]||(e[2]=r=>c.AddDocCat())},M)):p("",!0)]),s("div",j,[s("table",T,[s("caption",N,[f(n,{pagination:a.DocCatData,onPaginate:e[3]||(e[3]=r=>c.GetDocCat(r)),offset:4},null,8,["pagination"])]),s("thead",null,[s("tr",L,[V,U,d.store.get_permissions.includes("DOCMG_ACC_EDIT")||d.store.get_permissions.includes("DOCMG_ACC_DEL")||JSON.parse(d.store.get_user).user_type=="admin"?(o(),i("th",J,"ຈັດການ")):p("",!0),B])]),a.DocCatData.data.length>0?(o(),i("tbody",P,[t.loading_table?(o(),i("tr",R,q)):(o(!0),i(b,{key:1},S(a.DocCatData.data,r=>(o(),i("tr",{class:"cursor-pointer",key:r.id,onClick:v=>c.sent_id(r.id)},[s("td",null,D(r.name),1),s("td",H,D(t.formatPrice(r.price))+" ກີບ",1),d.store.get_permissions.includes("DOCMG_ACC_EDIT")||d.store.get_permissions.includes("DOCMG_ACC_DEL")||JSON.parse(d.store.get_user).user_type=="admin"?(o(),i("td",Q,[s("div",W,[X,s("div",Y,[d.store.get_permissions.includes("DOCMG_ACC_EDIT")||JSON.parse(d.store.get_user).user_type=="admin"?(o(),i("a",{key:0,class:"dropdown-item",href:"javascript:void(0);",onClick:v=>c.EditDocCat(r.id)},[ss,m(" ແກ້ໄຂ")],8,Z)):p("",!0),d.store.get_permissions.includes("DOCMG_ACC_DEL")||JSON.parse(d.store.get_user).user_type=="admin"?(o(),i("a",{key:1,class:"dropdown-item",href:"javascript:void(0);",onClick:v=>c.DeleteDocCat(r.id)},[ts,m(" ລຶບ")],8,es)):p("",!0)])])])):p("",!0),s("td",os,[s("div",is,[a.doc_cat_id==r.id?(o(),i("i",ns)):p("",!0)])])],8,z))),128))])):(o(),i("tbody",ds,as))])])]),s("div",ls,[s("div",rs,[s("form",_s,[s("div",ps,[s("button",ms,null,512)]),s("div",hs,[s("div",us,[s("div",gs,[fs,u(s("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=r=>a.doc_cat_name.name=r),class:"form-control",placeholder:"...."},null,512),[[g,a.doc_cat_name.name]])]),s("div",bs,[Ds,s("div",ys,[f(h,{options:t.options,modelValue:a.doc_cat_name.price,"onUpdate:modelValue":e[5]||(e[5]=r=>a.doc_cat_name.price=r),class:"form-control text-end",placeholder:"...."},null,8,["options","modelValue"]),xs])])]),s("div",vs,[s("button",{type:"button",class:"btn btn-primary me-2",disabled:c.check_bt,onClick:e[6]||(e[6]=r=>c.SaveDocCat())},[t.loading_post?(o(),i("div",ks,$s)):(o(),i("span",ws,"ບັນທຶກ"))],8,Cs),Fs])])])])])],64)}const Es=x(G,[["render",Gs]]),Is={setup(){return{store:w()}},mixins:[C],name:"DmsDoc",props:{catid:{type:Number}},data(){return{url:window.location.origin,DocData:[],upimg_pre:window.location.origin+"/assets/img/photo.png",upexp_pre:window.location.origin+"/assets/img/upload.png",upform_pre:window.location.origin+"/assets/img/upload.png",DocForm:{cat_id:"",doc_name:"",image:"",doc_example:"",doc_form:"",notice:""}}},computed:{check_bt(){return this.DocForm.doc_name==""?!0:!!this.loading_post}},mounted(){},methods:{downloadItem(t,e){window.open(t,"_blank")},rm_dimg(){this.DocForm.image="",this.upimg_pre=this.url+"/assets/img/photo.png"},rm_dexp(){this.DocForm.doc_example="",this.upexp_pre=this.url+"/assets/img/upload.png"},rm_dform(){this.DocForm.doc_form="",this.upform_pre=this.url+"/assets/img/upload.png"},onSelectImage(t){var e=t.target.files[0];if(e){this.DocForm.image=e;var _=new FileReader;_.onloadend=()=>{e.type.includes("image")?this.upimg_pre=_.result:e.type.includes("word")?this.upimg_pre=this.url+"/assets/img/word.png":e.type.includes("pdf")?this.upimg_pre=this.url+"/assets/img/pdf.png":this.upimg_pre=this.url+"/assets/img/document.png"},_.readAsDataURL(e)}},onSelectDocExample(t){var e=t.target.files[0];if(e){this.DocForm.doc_example=e;var _=new FileReader;_.onloadend=()=>{e.type.includes("image")?this.upexp_pre=_.result:e.type.includes("word")?this.upexp_pre=this.url+"/assets/img/word.png":e.type.includes("pdf")?this.upexp_pre=this.url+"/assets/img/pdf.png":this.upexp_pre=this.url+"/assets/img/document.png"},_.readAsDataURL(e)}},onSelectDocForm(t){var e=t.target.files[0];if(e){this.DocForm.doc_form=e;var _=new FileReader;_.onloadend=()=>{e.type.includes("image")?this.upform_pre=_.result:e.type.includes("word")?this.upform_pre=this.url+"/assets/img/word.png":e.type.includes("pdf")?this.upform_pre=this.url+"/assets/img/pdf.png":this.upform_pre=this.url+"/assets/img/document.png"},_.readAsDataURL(e)}},AddDoc(){this.FormType=!0,this.DocForm={cat_id:this.catid,doc_name:"",image:"",doc_example:"",doc_form:"",notice:""},this.upimg_pre=window.location.origin+"/assets/img/photo.png",this.upexp_pre=window.location.origin+"/assets/img/upload.png",this.upform_pre=window.location.origin+"/assets/img/upload.png";var t=new bootstrap.Modal(document.getElementById("docm"),{keyboard:!1});t.show()},SaveDoc(){this.FormType?this.AddData("doc/add",this.DocForm,t=>{t.success&&(this.$refs.close_docm.click(),this.GetDoc())}):this.UpdateData("doc/update/"+this.EditID,this.DocForm,t=>{t.success&&(this.$refs.close_docm.click(),this.GetDoc())})},EditDoc(t){this.EditData("doc/edit",t,e=>{this.DocForm=e,this.FormType=!1,this.EditID=t;var _=new bootstrap.Modal(document.getElementById("docm"),{keyboard:!1});_.show(),e.image?e.image.includes("jpg")||e.image.includes("jpeg")||e.image.includes("png")?this.upimg_pre=this.url+"/assets/file/"+e.image:e.image.includes("doc")||e.image.includes("docx")?this.upimg_pre=this.url+"/assets/img/word.png":e.image.includes("pdf")?this.upimg_pre=this.url+"/assets/img/pdf.png":this.upimg_pre=this.url+"/assets/img/document.png":this.upimg_pre=this.url+"/assets/img/photo.png",e.doc_example?e.doc_example.includes("jpg")||e.doc_example.includes("jpeg")||e.doc_example.includes("png")?this.upexp_pre=this.url+"/assets/file/"+e.doc_example:e.doc_example.includes("doc")||e.doc_example.includes("docx")?this.upexp_pre=this.url+"/assets/img/word.png":e.doc_example.includes("pdf")?this.upexp_pre=this.url+"/assets/img/pdf.png":this.upexp_pre=this.url+"/assets/img/document.png":this.upexp_pre=this.url+"/assets/img/upload.png",e.doc_form?e.doc_form.includes("jpg")||e.doc_form.includes("jpeg")||e.doc_form.includes("png")?this.upform_pre=this.url+"/assets/file/"+e.doc_form:e.doc_form.includes("doc")||e.doc_form.includes("docx")?this.upform_pre=this.url+"/assets/img/word.png":e.doc_form.includes("pdf")?this.upform_pre=this.url+"/assets/img/pdf.png":this.upform_pre=this.url+"/assets/img/document.png":this.upform_pre=this.url+"/assets/img/upload.png"})},DeleteDoc(t){this.DeleteData("doc/delete",t,e=>{e.success&&this.GetDoc()})},GetDoc(){this.GetData(`doc/get/${this.catid}?search=${this.Search}`,t=>{this.DocData=t})}},watch:{catid:function(t){t!=null&&this.GetDoc()},Search:function(t){t==""&&this.GetDoc()}}},l=t=>($("data-v-ba08f570"),t=t(),F(),t),Os={class:"card"},As={class:"d-flex justify-content-between p-3"},Ms={class:"text-wrap"},js=["disabled"],Ts=l(()=>s("i",{class:"bx bx-plus fs-4"},null,-1)),Ns=[Ts],Ls={class:"table-responsive text-nowrap"},Vs={class:"table"},Us={class:"border table-info"},Js=l(()=>s("th",{class:"fs-6 fw-bold"},"ລາຍການເອກະສານ",-1)),Bs={key:0,class:"fs-6 fw-bold text-center",width:"120"},Ps={key:0},Rs={key:0},Ks=l(()=>s("td",{colspan:"2",class:"text-center"},[s("div",{class:"spinner-border text-warning",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")])],-1)),qs=[Ks],zs={key:0,class:"text-danger"},Hs={key:0,class:"text-center"},Qs={class:"dropdown"},Ws=l(()=>s("button",{type:"button",class:"btn p-0 dropdown-toggle hide-arrow","data-bs-toggle":"dropdown"},[s("i",{class:"bx bx-dots-vertical-rounded"})],-1)),Xs={class:"dropdown-menu"},Ys=["onClick"],Zs=l(()=>s("i",{class:"bx bx-edit-alt me-1"},null,-1)),se=["onClick"],ee=l(()=>s("i",{class:"bx bx-trash me-1"},null,-1)),te={key:1},oe=l(()=>s("tr",null,[s("td",{colspan:"2",class:"text-center"},[s("i",{class:"bx bxs-data me-1"}),m(" ບໍ່ມີຂໍ້ມູນ ")])],-1)),ie=[oe],ne={class:"modal modal-top modal-lg fade",id:"docm",tabindex:"-1","data-bs-backdrop":"static",style:{display:"none"},"aria-hidden":"true"},de={class:"modal-dialog"},ce={class:"modal-content"},ae={class:"modal-header"},le={type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",ref:"close_docm"},re={class:"modal-body pt-0"},_e={class:"row"},pe={class:"col-6 mb-3"},me=l(()=>s("label",{class:"form-label fs-6"},[m("ຊື່ເອກະສານ "),s("span",{class:"text-danger"},"*")],-1)),he={class:"row"},ue={class:"col mb-3"},ge=l(()=>s("label",{class:"form-label fs-6 text-danger"},"ໝາຍເຫດ",-1)),fe={class:"row"},be={class:"col-md-4",style:{position:"relative"}},De=l(()=>s("i",{class:"bx bxs-x-circle"},null,-1)),ye=[De],xe=l(()=>s("label",{class:"form-label fs-6"},"ຮູບພາບ",-1)),ve=l(()=>s("br",null,null,-1)),Ce=["src"],we=l(()=>s("br",null,null,-1)),ke={class:"col-md-4",style:{position:"relative"}},Se=l(()=>s("i",{class:"bx bxs-x-circle"},null,-1)),$e=[Se],Fe=l(()=>s("label",{class:"form-label fs-6"},"ຕົວຢ່າງເອກະສານ",-1)),Ge=l(()=>s("br",null,null,-1)),Ee=["src"],Ie={class:"col-md-4",style:{position:"relative"}},Oe=l(()=>s("i",{class:"bx bxs-x-circle"},null,-1)),Ae=[Oe],Me=l(()=>s("label",{class:"form-label fs-6"},"ຟອມເອກະສານ",-1)),je=l(()=>s("br",null,null,-1)),Te=["src"],Ne={class:"d-flex justify-content-end mt-4"},Le=["disabled"],Ve={key:0},Ue={key:1,class:"spinner-border text-warning",role:"status"},Je=l(()=>s("span",{class:"visually-hidden"},"Loading...",-1)),Be=[Je],Pe=l(()=>s("button",{type:"button",class:"btn btn-label-secondary","data-bs-dismiss":"modal"},"ຍົກເລີກ",-1));function Re(t,e,_,d,a,c){return o(),i(b,null,[s("div",Os,[s("div",As,[s("div",Ms,[u(s("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=n=>t.Search=n),onKeyup:e[1]||(e[1]=k(n=>c.GetDoc(),["enter"])),placeholder:"ຄົ້ນຫາ..."},null,544),[[g,t.Search]])]),d.store.get_permissions.includes("DOCMG_ACC_EDIT")||JSON.parse(d.store.get_user).user_type=="admin"?(o(),i("button",{key:0,type:"button",class:"btn rounded-pill btn-icon btn-info",disabled:!_.catid,onClick:e[2]||(e[2]=n=>c.AddDoc())},Ns,8,js)):p("",!0)]),s("div",Ls,[s("table",Vs,[s("thead",null,[s("tr",Us,[Js,d.store.get_permissions.includes("DOCMG_ACC_EDIT")||d.store.get_permissions.includes("DOCMG_ACC_DEL")||JSON.parse(d.store.get_user).user_type=="admin"?(o(),i("th",Bs,"ຈັດການ")):p("",!0)])]),a.DocData.length>0?(o(),i("tbody",Ps,[t.loading_table?(o(),i("tr",Rs,qs)):(o(!0),i(b,{key:1},S(a.DocData,n=>(o(),i("tr",{key:n.id},[s("td",null,[m(D(n.doc_name)+" ",1),n.notice?(o(),i("span",zs,"("+D(n.notice)+") ",1)):p("",!0)]),d.store.get_permissions.includes("DOCMG_ACC_EDIT")||d.store.get_permissions.includes("DOCMG_ACC_DEL")||JSON.parse(d.store.get_user).user_type=="admin"?(o(),i("td",Hs,[s("div",Qs,[Ws,s("div",Xs,[d.store.get_permissions.includes("DOCMG_ACC_EDIT")||JSON.parse(d.store.get_user).user_type=="admin"?(o(),i("a",{key:0,class:"dropdown-item",href:"javascript:void(0);",onClick:h=>c.EditDoc(n.id)},[Zs,m(" ແກ້ໄຂ")],8,Ys)):p("",!0),d.store.get_permissions.includes("DOCMG_ACC_DEL")||JSON.parse(d.store.get_user).user_type=="admin"?(o(),i("a",{key:1,class:"dropdown-item",href:"javascript:void(0);",onClick:h=>c.DeleteDoc(n.id)},[ee,m(" ລຶບ")],8,se)):p("",!0)])])])):p("",!0)]))),128))])):(o(),i("tbody",te,ie))])])]),s("div",ne,[s("div",de,[s("form",ce,[s("div",ae,[s("button",le,null,512)]),s("div",re,[s("div",_e,[s("div",pe,[me,u(s("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=n=>a.DocForm.doc_name=n),class:"form-control",placeholder:"...."},null,512),[[g,a.DocForm.doc_name]])])]),s("div",he,[s("div",ue,[ge,u(s("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=n=>a.DocForm.notice=n),class:"form-control",placeholder:"...."},null,512),[[g,a.DocForm.notice]])])]),s("div",fe,[s("div",be,[a.DocForm.image?(o(),i("span",{key:0,class:"text-danger x-icon",onClick:e[5]||(e[5]=n=>c.rm_dimg())},ye)):p("",!0),xe,ve,s("img",{src:a.upimg_pre,class:"rounded exp-img cursor-pointer",onClick:e[6]||(e[6]=n=>t.$refs.doc_img.click())},null,8,Ce),s("input",{type:"file",ref:"doc_img",onChange:e[7]||(e[7]=(...n)=>c.onSelectImage&&c.onSelectImage(...n)),style:{display:"none"},class:"form-control",placeholder:"...."},null,544),m(),we]),s("div",ke,[a.DocForm.doc_example?(o(),i("span",{key:0,class:"text-danger x-icon",onClick:e[8]||(e[8]=n=>c.rm_dexp())},$e)):p("",!0),Fe,Ge,s("img",{src:a.upexp_pre,class:"rounded exp-img cursor-pointer",onClick:e[9]||(e[9]=n=>t.$refs.doc_exp.click())},null,8,Ee),s("input",{type:"file",ref:"doc_exp",onChange:e[10]||(e[10]=(...n)=>c.onSelectDocExample&&c.onSelectDocExample(...n)),style:{display:"none"},class:"form-control",placeholder:"...."},null,544)]),s("div",Ie,[a.DocForm.doc_form?(o(),i("span",{key:0,class:"text-danger x-icon",onClick:e[11]||(e[11]=n=>c.rm_dform())},Ae)):p("",!0),Me,je,s("img",{src:a.upform_pre,class:"rounded exp-img cursor-pointer",onClick:e[12]||(e[12]=n=>t.$refs.doc_form.click())},null,8,Te),s("input",{type:"file",ref:"doc_form",onChange:e[13]||(e[13]=(...n)=>c.onSelectDocForm&&c.onSelectDocForm(...n)),style:{display:"none"},class:"form-control",placeholder:"...."},null,544)])]),s("div",Ne,[s("button",{type:"button",class:"btn btn-primary me-2",disabled:c.check_bt,onClick:e[14]||(e[14]=n=>c.SaveDoc())},[t.loading_post?(o(),i("div",Ue,Be)):(o(),i("span",Ve,"ບັນທຶກ"))],8,Le),Pe])])])])])],64)}const Ke=x(Is,[["render",Re],["__scopeId","data-v-ba08f570"]]),qe={name:"DmsPreDocMg",data(){return{cateid:0}},mounted(){},components:{DocCat:Es,Doc:Ke},methods:{get_dcid(t){this.cateid=t}}},ze={class:"row"},He={class:"col-md-6"},Qe={class:"col-md-6"};function We(t,e,_,d,a,c){const n=y("DocCat"),h=y("Doc");return o(),i("div",ze,[s("div",He,[f(n,{onCatid:e[0]||(e[0]=r=>c.get_dcid(r))})]),s("div",Qe,[f(h,{catid:a.cateid},null,8,["catid"])])])}const Ze=x(qe,[["render",We]]);export{Ze as default};
