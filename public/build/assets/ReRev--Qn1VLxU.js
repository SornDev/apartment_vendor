import{m as f,h as _}from"./ulmixins-3GuYya29.js";import{C as x}from"./flatpickr-tehUNNhR.js";import{_ as b,c as r,a as t,n as m,f as l,e as y,b as h,t as o,F as w,r as D,g as v,o as c,p as g,q as Y}from"./app-R5zms-zh.js";const k={name:"DmsReRev",mixins:[f],data(){return{DataBefore:{income:0,expense:0,total:0},FinanceData:[],date_tran:_().format("YYYY-MM-DD"),dmy:"m",config:{wrap:!0,altFormat:"d/m/Y",altInput:!0,dateFormat:"Y-m-d",allowInput:!1}}},components:{flatPickr:x,moment:_},mounted(){},computed:{subtotal_income_no(){let e=0;return this.FinanceData.forEach(s=>{s.tran_type=="income"&&(e+=parseInt(s.price||0))}),e},subtotal_expense_no(){let e=0;return this.FinanceData.forEach(s=>{s.tran_type=="expense"&&(e+=parseInt(s.price||0))}),e},subtotal_income(){let e=parseInt(this.DataBefore.income);return this.FinanceData.forEach(s=>{s.tran_type=="income"&&(e+=parseInt(s.price||0))}),e},subtotal_expense(){let e=parseInt(this.DataBefore.expense);return this.FinanceData.forEach(s=>{s.tran_type=="expense"&&(e+=parseInt(s.price||0))}),e},sum_suntotal(){return parseInt(this.subtotal_income)-parseInt(this.subtotal_expense)},GetShowDate(){return this.GetDate(this.date_tran)},GetShowMonth(){return this.GetMonth(this.date_tran)},GetShowYear(){return this.GetYear(this.date_tran)}},methods:{GetDate(e){return _(e).format("DD/MM/YYYY")},GetMonth(e){return _(e).format("MM/YYYY")},GetYear(e){return _(e).format("YYYY")},GetReport(e){this.GetDataPost(`report/finance?pdf=${e}`,{date_tran:this.date_tran,dmy:this.dmy},s=>{s.success&&(this.DataBefore.income=s.sum_income_before,this.DataBefore.expense=s.sum_expense_before,this.DataBefore.total=s.subtotal_before,this.FinanceData=s.transection,s.fileUrl&&window.open(s.fileUrl,"_blank"))})}},created(){this.GetReport()},watch:{date_tran:function(e){this.GetReport()},dmy:function(e){this.GetReport()}}},i=e=>(g("data-v-f98e33a6"),e=e(),Y(),e),G={class:"row"},P={class:"col-md-12"},I={class:"card mb-4"},B=i(()=>t("h5",{class:"card-header"},"ລາຍງານ ຕິດຕາມເງິນສົດ",-1)),F={class:"card-body"},M={class:"d-sm-flex align-items-center justify-content-between border-bottom pb-2"},S={class:"align-items-center"},C={class:"input-group input-group",style:{width:"220px"}},R={class:"input-group-text"},V={key:0,class:"bx bx-chevron-right"},E={key:0,class:"bx bx-chevron-right"},j={key:0,class:"bx bx-chevron-right"},N=i(()=>t("i",{class:"bx bxs-file-pdf fs-4 me-1"},null,-1)),U={class:"mt-2 mb-4"},q={class:"text-center"},z=i(()=>t("h4",null,"ລາຍງານ ຕິດຕາມເງິນສົດ",-1)),L={class:"text-danger"},T={key:0},A={key:1},H={key:2},J={class:"d-flex justify-content-center"},K={class:"table-responsive mt-4"},O={class:"table table-bordered border-secondary table-nowrap align-middle mb-0",style:{width:"800px"}},Q=i(()=>t("thead",null,[t("tr",null,[t("th",{scope:"col",rowspan:"2",width:"80",class:"align-middle text-center fs-6"}," ລ/ດ"),t("th",{scope:"col",rowspan:"2",width:"120",class:"align-middle text-center fs-6"},"ວັນເດືອນປີ"),t("th",{scope:"col",rowspan:"2",width:"80",class:"align-middle text-center fs-6"},"ເລກທີ່"),t("th",{scope:"col",rowspan:"2",class:"align-middle text-center fs-6"},"ເນື້ອໃນ"),t("th",{scope:"col",colspan:"2",class:"align-middle text-center fs-6"},"ຈຳນວນເງິນ"),t("th",{scope:"col",rowspan:"2",width:"130",class:"align-middle text-center fs-6"},"ຍອດເຫຼືອ")]),t("tr",null,[t("th",{class:"align-middle text-center fs-6",width:"130"},"ຮັບເຂົ້າ"),t("th",{class:"align-middle text-center fs-6",width:"130"},"ຈ່າຍອອກ")])],-1)),W=i(()=>t("td",{colspan:"4",class:"text-end"},"ຍອດຍົກມາ",-1)),X={class:"text-end"},Z={class:"text-end"},$={class:"text-end"},tt={class:"text-center"},et={class:"text-end"},st={key:0},nt={class:"text-end"},ot={key:0},at={class:"text-end"},rt={key:0},ct=i(()=>t("td",{colspan:"7",class:"p-4 text-center"},[t("div",{class:"d-flex align-items-center justify-content-center w-100"},[t("i",{class:"bx bx-data fs-4 text-muted"}),h(),t("span",{class:"text-muted"}," ບໍ່ມີຂໍ້ມູນການເຄື່ອນໄຫວ... ")])],-1)),dt=[ct],it=i(()=>t("td",{colspan:"4",class:"text-end"},"ລວມຍອດ",-1)),lt={class:"text-end"},_t={class:"text-end"},ht={class:"text-end"},mt={class:"d-flex justify-content-center mt-2"},pt={class:"border table-bordered",style:{width:"350px"}},ut=i(()=>t("td",{width:"180",class:"text-end p-1"},"ຍອດຍົກມາ:",-1)),ft={class:"text-end p-1"},xt=i(()=>t("td",{class:"text-end p-1"},"ເກີດຂື້ນຮັບເຂົ້າ:",-1)),bt={class:"text-end p-1"},yt=i(()=>t("td",{class:"text-end p-1"},"ເກີດຂື້ນຮັບອອກ:",-1)),wt={class:"text-end p-1"},Dt=i(()=>t("td",{class:"text-end p-1"},"ຍອດເຫຼືອ:",-1)),vt={class:"text-end p-1"};function gt(e,s,Yt,kt,n,d){const p=v("flat-pickr");return c(),r("div",G,[t("div",P,[t("div",I,[B,t("div",F,[t("div",M,[t("div",S,[t("div",C,[t("span",R,[t("span",{class:m(n.dmy=="d"?"text-success":"")},[n.dmy=="d"?(c(),r("i",V)):l("",!0),t("span",{class:"cursor-pointer me-2",onClick:s[0]||(s[0]=a=>n.dmy="d")},"ວັນ")],2),t("span",{class:m(n.dmy=="m"?"text-success":"")},[n.dmy=="m"?(c(),r("i",E)):l("",!0),t("span",{class:"cursor-pointer me-2",onClick:s[1]||(s[1]=a=>n.dmy="m")},"ເດືອນ")],2),t("span",{class:m(n.dmy=="y"?"text-success":"")},[n.dmy=="y"?(c(),r("i",j)):l("",!0),t("span",{class:"cursor-pointer",onClick:s[2]||(s[2]=a=>n.dmy="y")},"ປີ")],2)]),y(p,{modelValue:n.date_tran,"onUpdate:modelValue":s[3]||(s[3]=a=>n.date_tran=a),config:n.config,class:"form-control",placeholder:"ວັນທີ່"},null,8,["modelValue","config"])])]),t("div",null,[t("button",{class:"btn btn-info",onClick:s[4]||(s[4]=a=>d.GetReport("true"))},[N,h(" ສ້າງລາຍງານ PDF ")])])]),t("div",null,[t("div",U,[t("div",q,[z,t("p",L,[h("ປະຈຳ: "),n.dmy=="d"?(c(),r("span",T,"ວັນ "+o(d.GetShowDate),1)):l("",!0),n.dmy=="m"?(c(),r("span",A,"ເດືອນ "+o(d.GetShowMonth),1)):l("",!0),h(),n.dmy=="y"?(c(),r("span",H,"ປີ "+o(d.GetShowYear),1)):l("",!0)])]),t("div",J,[t("div",K,[t("table",O,[Q,t("tbody",null,[t("tr",null,[W,t("td",X,o(e.formatPrice(n.DataBefore.income)),1),t("td",Z,o(e.formatPrice(n.DataBefore.expense)),1),t("td",$,o(e.formatPrice(n.DataBefore.total)),1)]),(c(!0),r(w,null,D(n.FinanceData,(a,u)=>(c(),r("tr",{key:a.id},[t("td",tt,o(u+1),1),t("td",null,o(d.GetDate(a.created_at)),1),t("td",null,o(a.tran_id),1),t("td",null,o(a.tran_details),1),t("td",et,[a.tran_type=="income"?(c(),r("span",st,o(e.formatPrice(a.price)),1)):l("",!0)]),t("td",nt,[a.tran_type=="expense"?(c(),r("span",ot,o(e.formatPrice(a.price)),1)):l("",!0)]),t("td",at,o(e.formatPrice(a.subtotal)),1)]))),128)),n.FinanceData.length?l("",!0):(c(),r("tr",rt,dt)),t("tr",null,[it,t("td",lt,o(e.formatPrice(d.subtotal_income)),1),t("td",_t,o(e.formatPrice(d.subtotal_expense)),1),t("td",ht,o(e.formatPrice(d.sum_suntotal)),1)])])]),t("div",mt,[t("table",pt,[t("tbody",null,[t("tr",null,[ut,t("td",ft,o(e.formatPrice(n.DataBefore.total)),1)]),t("tr",null,[xt,t("td",bt,o(e.formatPrice(d.subtotal_income_no)),1)]),t("tr",null,[yt,t("td",wt,o(e.formatPrice(d.subtotal_expense_no)),1)]),t("tr",null,[Dt,t("td",vt,o(e.formatPrice(d.sum_suntotal)),1)])])])])])])])])])])])])}const Bt=b(k,[["render",gt],["__scopeId","data-v-f98e33a6"]]);export{Bt as default};
