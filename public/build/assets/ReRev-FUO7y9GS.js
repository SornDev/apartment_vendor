import{_ as f,m as x,k as _,r as b,o as r,c,b as t,d as l,q as p,e as y,i as h,t as o,F as w,h as v,p as g,j as D}from"./app-JtYbRyaD.js";import{C as k}from"./flatpickr-CkvweW_Y.js";const Y={name:"DmsReRev",mixins:[x],data(){return{created_report:!1,DataBefore:{income:0,expense:0,total:0},FinanceData:[],date_tran:_().format("YYYY-MM-DD"),dmy:"m",config:{wrap:!0,altFormat:"d/m/Y",altInput:!0,dateFormat:"Y-m-d",allowInput:!1}}},components:{flatPickr:k,moment:_},mounted(){},computed:{subtotal_income_no(){let e=0;return this.FinanceData.forEach(s=>{s.tran_type=="income"&&(e+=parseInt(s.price||0))}),e},subtotal_expense_no(){let e=0;return this.FinanceData.forEach(s=>{s.tran_type=="expense"&&(e+=parseInt(s.price||0))}),e},subtotal_income(){let e=parseInt(this.DataBefore.income);return this.FinanceData.forEach(s=>{s.tran_type=="income"&&(e+=parseInt(s.price||0))}),e},subtotal_expense(){let e=parseInt(this.DataBefore.expense);return this.FinanceData.forEach(s=>{s.tran_type=="expense"&&(e+=parseInt(s.price||0))}),e},sum_suntotal(){return parseInt(this.subtotal_income)-parseInt(this.subtotal_expense)},GetShowDate(){return this.GetDate(this.date_tran)},GetShowMonth(){return this.GetMonth(this.date_tran)},GetShowYear(){return this.GetYear(this.date_tran)}},methods:{GetDate(e){return _(e).format("DD/MM/YYYY")},GetMonth(e){return _(e).format("MM/YYYY")},GetYear(e){return _(e).format("YYYY")},GetReport(e){this.created_report=!0,this.GetDataPost(`report/finance?pdf=${e}`,{date_tran:this.date_tran,dmy:this.dmy},s=>{this.created_report=!1,s.success&&(this.DataBefore.income=s.sum_income_before,this.DataBefore.expense=s.sum_expense_before,this.DataBefore.total=s.subtotal_before,this.FinanceData=s.transection,s.fileUrl&&window.open(s.fileUrl,"_blank"))})}},created(){this.GetReport()},watch:{date_tran:function(e){this.GetReport()},dmy:function(e){this.GetReport()}}},d=e=>(g("data-v-f373c4df"),e=e(),D(),e),G={class:"row"},P={class:"col-md-12"},I={class:"card mb-4"},B={class:"card-header d-flex"},F=d(()=>t("h5",{class:"mb-0"},"ລາຍງານ ຕິດຕາມເງິນສົດ",-1)),M={key:0,class:"spinner-grow spinner-grow-sm text-warning ms-2",role:"status"},S=d(()=>t("span",{class:"visually-hidden"},"Loading...",-1)),C=[S],R={class:"card-body"},V={class:"d-sm-flex align-items-center justify-content-between border-bottom pb-2"},j={class:"align-items-center"},E={class:"input-group input-group",style:{width:"220px"}},N={class:"input-group-text"},U={key:0,class:"bx bx-chevron-right"},L={key:0,class:"bx bx-chevron-right"},q={key:0,class:"bx bx-chevron-right"},z={key:0},T=d(()=>t("span",{class:"spinner-border me-1",role:"status","aria-hidden":"true"},null,-1)),A={key:1,class:"d-flex align-items-center"},H=d(()=>t("i",{class:"bx bxs-file-pdf fs-4 me-1"},null,-1)),J={class:"mt-2 mb-4"},K={class:"text-center"},O=d(()=>t("h4",null,"ລາຍງານ ຕິດຕາມເງິນສົດ",-1)),Q={class:"text-danger"},W={key:0},X={key:1},Z={key:2},$={class:"d-flex justify-content-center"},tt={class:"table-responsive mt-4"},et={class:"table table-bordered border-secondary table-nowrap align-middle mb-0",style:{width:"800px"}},st=d(()=>t("thead",null,[t("tr",null,[t("th",{scope:"col",rowspan:"2",width:"80",class:"align-middle text-center fs-6"}," ລ/ດ"),t("th",{scope:"col",rowspan:"2",width:"120",class:"align-middle text-center fs-6"},"ວັນເດືອນປີ"),t("th",{scope:"col",rowspan:"2",width:"80",class:"align-middle text-center fs-6"},"ເລກທີ່"),t("th",{scope:"col",rowspan:"2",class:"align-middle text-center fs-6"},"ເນື້ອໃນ"),t("th",{scope:"col",colspan:"2",class:"align-middle text-center fs-6"},"ຈຳນວນເງິນ"),t("th",{scope:"col",rowspan:"2",width:"130",class:"align-middle text-center fs-6"},"ຍອດເຫຼືອ")]),t("tr",null,[t("th",{class:"align-middle text-center fs-6",width:"130"},"ຮັບເຂົ້າ"),t("th",{class:"align-middle text-center fs-6",width:"130"},"ຈ່າຍອອກ")])],-1)),nt=d(()=>t("td",{colspan:"4",class:"text-end"},"ຍອດຍົກມາ",-1)),ot={class:"text-end"},at={class:"text-end"},rt={class:"text-end"},ct={class:"text-center"},dt={class:"text-end"},it={key:0},lt={class:"text-end"},_t={key:0},ht={class:"text-end"},pt={key:0},mt=d(()=>t("td",{colspan:"7",class:"p-4 text-center"},[t("div",{class:"d-flex align-items-center justify-content-center w-100"},[t("i",{class:"bx bx-data fs-4 text-muted"}),h(),t("span",{class:"text-muted"}," ບໍ່ມີຂໍ້ມູນການເຄື່ອນໄຫວ... ")])],-1)),ut=[mt],ft=d(()=>t("td",{colspan:"4",class:"text-end"},"ລວມຍອດ",-1)),xt={class:"text-end"},bt={class:"text-end"},yt={class:"text-end"},wt={class:"d-flex justify-content-center mt-2"},vt={class:"border table-bordered",style:{width:"350px"}},gt=d(()=>t("td",{width:"180",class:"text-end p-1"},"ຍອດຍົກມາ:",-1)),Dt={class:"text-end p-1"},kt=d(()=>t("td",{class:"text-end p-1"},"ເກີດຂື້ນຮັບເຂົ້າ:",-1)),Yt={class:"text-end p-1"},Gt=d(()=>t("td",{class:"text-end p-1"},"ເກີດຂື້ນຈ່າຍອອກ:",-1)),Pt={class:"text-end p-1"},It=d(()=>t("td",{class:"text-end p-1"},"ຍອດເຫຼືອ:",-1)),Bt={class:"text-end p-1"};function Ft(e,s,Mt,St,n,i){const m=b("flat-pickr");return r(),c("div",G,[t("div",P,[t("div",I,[t("div",B,[F,e.loading_table?(r(),c("div",M,C)):l("",!0)]),t("div",R,[t("div",V,[t("div",j,[t("div",E,[t("span",N,[t("span",{class:p(n.dmy=="d"?"text-success":"")},[n.dmy=="d"?(r(),c("i",U)):l("",!0),t("span",{class:"cursor-pointer me-2",onClick:s[0]||(s[0]=a=>n.dmy="d")},"ວັນ")],2),t("span",{class:p(n.dmy=="m"?"text-success":"")},[n.dmy=="m"?(r(),c("i",L)):l("",!0),t("span",{class:"cursor-pointer me-2",onClick:s[1]||(s[1]=a=>n.dmy="m")},"ເດືອນ")],2),t("span",{class:p(n.dmy=="y"?"text-success":"")},[n.dmy=="y"?(r(),c("i",q)):l("",!0),t("span",{class:"cursor-pointer",onClick:s[2]||(s[2]=a=>n.dmy="y")},"ປີ")],2)]),y(m,{modelValue:n.date_tran,"onUpdate:modelValue":s[3]||(s[3]=a=>n.date_tran=a),config:n.config,class:"form-control",placeholder:"ວັນທີ່"},null,8,["modelValue","config"])])]),t("div",null,[t("button",{class:"btn btn-info",onClick:s[4]||(s[4]=a=>i.GetReport("true"))},[n.created_report?(r(),c("span",z,[T,h(" ກຳລັງສ້າງ... ")])):(r(),c("span",A,[H,h(" ສ້າງລາຍງານ PDF ")]))])])]),t("div",null,[t("div",J,[t("div",K,[O,t("p",Q,[h("ປະຈຳ: "),n.dmy=="d"?(r(),c("span",W,"ວັນ "+o(i.GetShowDate),1)):l("",!0),n.dmy=="m"?(r(),c("span",X,"ເດືອນ "+o(i.GetShowMonth),1)):l("",!0),h(),n.dmy=="y"?(r(),c("span",Z,"ປີ "+o(i.GetShowYear),1)):l("",!0)])]),t("div",$,[t("div",tt,[t("table",et,[st,t("tbody",null,[t("tr",null,[nt,t("td",ot,o(e.formatPrice(n.DataBefore.income)),1),t("td",at,o(e.formatPrice(n.DataBefore.expense)),1),t("td",rt,o(e.formatPrice(n.DataBefore.total)),1)]),(r(!0),c(w,null,v(n.FinanceData,(a,u)=>(r(),c("tr",{key:a.id},[t("td",ct,o(u+1),1),t("td",null,o(i.GetDate(a.created_at)),1),t("td",null,o(a.tran_id),1),t("td",null,o(a.tran_details),1),t("td",dt,[a.tran_type=="income"?(r(),c("span",it,o(e.formatPrice(a.price)),1)):l("",!0)]),t("td",lt,[a.tran_type=="expense"?(r(),c("span",_t,o(e.formatPrice(a.price)),1)):l("",!0)]),t("td",ht,o(e.formatPrice(a.subtotal)),1)]))),128)),n.FinanceData.length?l("",!0):(r(),c("tr",pt,ut)),t("tr",null,[ft,t("td",xt,o(e.formatPrice(i.subtotal_income)),1),t("td",bt,o(e.formatPrice(i.subtotal_expense)),1),t("td",yt,o(e.formatPrice(i.sum_suntotal)),1)])])]),t("div",wt,[t("table",vt,[t("tbody",null,[t("tr",null,[gt,t("td",Dt,o(e.formatPrice(n.DataBefore.total)),1)]),t("tr",null,[kt,t("td",Yt,o(e.formatPrice(i.subtotal_income_no)),1)]),t("tr",null,[Gt,t("td",Pt,o(e.formatPrice(i.subtotal_expense_no)),1)]),t("tr",null,[It,t("td",Bt,o(e.formatPrice(i.sum_suntotal)),1)])])])])])])])])])])])])}const Vt=f(Y,[["render",Ft],["__scopeId","data-v-f373c4df"]]);export{Vt as default};
