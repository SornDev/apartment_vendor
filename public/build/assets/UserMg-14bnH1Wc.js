import{m as U}from"./ulmixins-6Aw97T0R.js";import{_ as y,c as i,a as s,w as n,i as h,v as c,d as w,F as f,j as F,f as k,e as p,q as b,r as x,o as a,k as m,t as u,p as S,l as D}from"./app-tVS7sfzb.js";const V={name:"DmsUserMg",mixins:[U],data(){return{url:window.location.origin,user_img_pre:window.location.origin+"/assets/img/no-img.jpeg",UserData:{data:[]},UserForm:{name:"",last_name:"",gender:"male",staff_type:"user",user_name:"",password:"",image:"",tel:"",address:"",roles:"",status:"active"}}},computed:{check_bt(){return this.UserForm.name==""||this.UserForm.last_name==""||this.UserForm.tel==""||this.UserForm.address==""||this.UserForm.staff_type=="user"&&this.UserForm.user_name==""||this.UserForm.staff_type=="user"&&this.UserForm.password==""?!0:!!this.loading_post}},mounted(){},methods:{ChangeSort(){this.Sort=="asc"?this.Sort="desc":this.Sort="asc",this.GetUser()},rmimg(){this.UserForm.image="",this.user_img_pre=this.url+"/assets/img/no-img.jpeg"},onSelectImage(r){var e=r.target.files[0];if(e){this.UserForm.image=e;var _=new FileReader;_.onloadend=()=>{e.type.includes("image")?this.user_img_pre=_.result:e.type.includes("word")?this.user_img_pre=this.url+"/assets/img/word.png":e.type.includes("pdf")?this.user_img_pre=this.url+"/assets/img/pdf.png":this.user_img_pre=this.url+"/assets/img/document.png"},_.readAsDataURL(e)}},AddUser(){this.FormType=!0,this.UserForm={name:"",last_name:"",gender:"male",staff_type:"user",user_name:"",password:"",image:"",tel:"",address:"",roles:"",status:"active"};var r=new bootstrap.Modal(document.getElementById("user-form"),{keyboard:!1});r.show()},SaveUser(){this.FormType?this.AddData("user/add",this.UserForm,r=>{r.success&&(this.$refs.close_use_form.click(),this.GetUser())}):this.UpdateData("user/update/"+this.EditID,this.UserForm,r=>{r.success&&(this.$refs.close_use_form.click(),this.GetUser())})},EditUser(r){this.FormType=!1,this.EditData("user/edit",r,e=>{this.UserForm=e,e.image?this.user_img_pre=this.url+"/assets/img/"+e.image:this.user_img_pre=this.url+"/assets/img/no-img.jpeg";var _=new bootstrap.Modal(document.getElementById("user-form"),{keyboard:!1});_.show()})},DeleteUser(r){this.DeleteData("user/delete",r,e=>{e.success&&this.GetUser()})},GetUser(r){this.GetData(`user/get?page=${r}&perpage=${this.PerPage}&sort=${this.Sort}&search=${this.Search}`,e=>{this.UserData=e})}},created(){this.GetUser()},watch:{Search:function(r){r==""&&this.GetUser()}}},o=r=>(S("data-v-298cd649"),r=r(),D(),r),C={class:"card"},j=o(()=>s("h5",{class:"card-header"},"ຈັດການຜູ້ໃຊ້",-1)),G={class:"card-body"},I={class:"table-responsive text-nowrap"},E={class:"d-flex justify-content-between mb-2"},M={class:"d-flex justify-content-between align-items-center"},P={key:0,class:"bx bx-sort-up fs-4 me-2"},B={key:1,class:"bx bx-sort-down fs-4 me-2"},T=o(()=>s("option",{value:"10"},"10",-1)),A=o(()=>s("option",{value:"20"},"20",-1)),L=o(()=>s("option",{value:"30"},"30",-1)),N=[T,A,L],R={class:"d-flex"},K={class:"table table-bordered"},q=o(()=>s("thead",null,[s("tr",{class:"table-info"},[s("th",{class:"fs-6 fw-bold",width:"40"}),s("th",{class:"fs-6 fw-bold"},"ຊື່ ແລະ ນາມສະກຸນ"),s("th",{class:"fs-6 fw-bold"},"ທີ່ຢູ່ / ຕິດຕໍ່"),s("th",{class:"fs-6 fw-bold"},"ຊື່ຜູ້ໃຊ້"),s("th",{class:"fs-6 fw-bold",width:"110"},"ສະຖານະ"),s("th",{class:"fs-6 fw-bold",width:"100"},"ຈັດການ")])],-1)),z={key:0},H={key:0},J=o(()=>s("td",{colspan:"6",class:"text-center"},[s("div",{class:"spinner-border text-warning",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")])],-1)),O=[J],Q=["src"],W=["src"],X={key:0},Y=o(()=>s("br",null,null,-1)),Z={class:"text-center"},$={key:0,class:"badge bg-label-success"},ss={key:1,class:"badge bg-label-danger"},es={class:"text-center"},ts={class:"dropdown"},os=o(()=>s("button",{type:"button",class:"btn p-0 dropdown-toggle hide-arrow","data-bs-toggle":"dropdown"},[s("i",{class:"bx bx-dots-vertical-rounded"})],-1)),ls={class:"dropdown-menu"},rs=["onClick"],is=o(()=>s("i",{class:"bx bx-edit-alt me-1"},null,-1)),as=["onClick"],ns=o(()=>s("i",{class:"bx bx-trash me-1"},null,-1)),ds={key:1},cs=o(()=>s("tr",null,[s("td",{colspan:"6",class:"text-center"},[s("i",{class:"bx bxs-data me-1"}),m(" ບໍ່ມີຂໍ້ມູນ ")])],-1)),ms=[cs],_s={class:"modal modal-top modal-md fade","data-bs-backdrop":"static",id:"user-form",tabindex:"-1",style:{display:"none"},"aria-hidden":"true"},us={class:"modal-dialog"},hs={class:"modal-content"},ps={class:"modal-header"},fs={type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",ref:"close_use_form"},bs={class:"modal-body pt-0"},gs={class:"row"},vs={class:"col-12 mb-3"},Us={class:"d-flex justify-content-center"},ys={class:"position-relative"},ws=["src"],Fs={class:"position-absolute top-0 end-0"},ks=o(()=>s("i",{class:"bx bx-x fs-4"},null,-1)),xs=[ks],Ss={class:"row mb-2"},Ds={class:"col-md-6"},Vs=o(()=>s("label",{for:"f-name",class:"fs-6"},"ຊື່:",-1)),Cs={class:"col-md-6"},js=o(()=>s("label",{for:"f-lastname",class:"fs-6"},"ນາມສະກຸນ:",-1)),Gs={class:"row mb-2"},Is={class:"col-md-6"},Es=o(()=>s("label",{for:"",class:"fs-6 me-2 mb-2"},"ເພດ:",-1)),Ms={class:"d-flex align-items-center"},Ps={class:"form-check me-2"},Bs=o(()=>s("label",{class:"form-check-label",for:"male"}," ຊາຍ ",-1)),Ts={class:"form-check me-2"},As=o(()=>s("label",{class:"form-check-label",for:"female"}," ຍິງ ",-1)),Ls={class:"col-md-6"},Ns=o(()=>s("label",{for:"st",class:"form-label fs-6"},"ປະເພດຜູ້ໃຊ້:",-1)),Rs=o(()=>s("option",{value:"staff"},"ພະນັກງານ",-1)),Ks=o(()=>s("option",{value:"user"},"ພະນັກງານ ແລະ ຜູ້ໃຊ້ງານ",-1)),qs=[Rs,Ks],zs={key:0,class:"row mb-2"},Hs={class:"col-md-6"},Js=o(()=>s("label",{for:"user-name",class:"form-label fs-6"},"ຊື່ຜູ້ໃຊ້:",-1)),Os={class:"col-md-6"},Qs=o(()=>s("label",{for:"user-pass",class:"form-label fs-6"},"ລະຫັດຜ່ານ:",-1)),Ws={class:"row mb-2"},Xs={class:"col-md-6"},Ys=o(()=>s("label",{for:"tel",class:"form-label fs-6"},"ເບີໂທ:",-1)),Zs={class:"col-md-6"},$s=o(()=>s("label",{for:"address",class:"form-label fs-6"},"ທີ່ຢູ່:",-1)),se={class:"row mb-2"},ee={class:"col-md-6"},te=o(()=>s("label",{for:"rolse",class:"form-label fs-6"},"ສິດຜູ້ໃຊ້:",-1)),oe=o(()=>s("option",{value:"staff"},"ພະນັກງານ",-1)),le=o(()=>s("option",{value:"user"},"ພະນັກງານ ແລະ ຜູ້ໃຊ້ງານ",-1)),re=[oe,le],ie={class:"col-md-6"},ae=o(()=>s("label",{for:"status",class:"form-label fs-6"},"ສະຖານະ:",-1)),ne=o(()=>s("option",{value:"active"},"ໃຊ້ງານຢູ່",-1)),de=o(()=>s("option",{value:"disable"},"ປິດ",-1)),ce=[ne,de],me={class:"d-flex justify-content-end mt-4"},_e=["disabled"],ue={key:0},he={key:1,class:"spinner-border text-warning",role:"status"},pe=o(()=>s("span",{class:"visually-hidden"},"Loading...",-1)),fe=[pe],be=o(()=>s("button",{type:"button",class:"btn btn-label-secondary","data-bs-dismiss":"modal"},"ຍົກເລີກ",-1));function ge(r,e,_,ve,l,d){const g=x("pagination");return a(),i(f,null,[s("div",C,[j,s("div",G,[s("div",I,[s("div",E,[s("div",M,[s("div",{class:"cursor-pointer",onClick:e[0]||(e[0]=t=>d.ChangeSort())},[r.Sort=="asc"?(a(),i("i",P)):(a(),i("i",B))]),n(s("select",{class:"form-select me-2","onUpdate:modelValue":e[1]||(e[1]=t=>r.PerPage=t),onChange:e[2]||(e[2]=t=>d.GetUser())},N,544),[[h,r.PerPage]])]),s("div",R,[n(s("input",{type:"text",class:"form-control me-2","onUpdate:modelValue":e[3]||(e[3]=t=>r.Search=t),onKeyup:e[4]||(e[4]=w(t=>d.GetUser(),["enter"])),placeholder:"ຄົ້ນຫາ..."},null,544),[[c,r.Search]]),s("button",{class:"btn btn-primary",onClick:e[5]||(e[5]=t=>d.AddUser())},"ເພີ່ມໃໝ່")])]),s("table",K,[q,l.UserData.data.length>0?(a(),i("tbody",z,[r.loading_table?(a(),i("tr",H,O)):(a(!0),i(f,{key:1},F(l.UserData.data,t=>(a(),i("tr",{key:t.id},[s("td",null,[t.image?(a(),i("img",{key:0,src:l.url+"/assets/img/"+t.image,class:"rounded-circle avatar imc"},null,8,Q)):(a(),i("img",{key:1,src:l.url+"/assets/img/no-img.jpeg",class:"rounded-circle avatar imc"},null,8,W))]),s("td",null,[m(" ທ່ານ "),t.gender=="female"?(a(),i("span",X,"ນ")):p("",!0),m(" "+u(t.name)+" "+u(t.last_name),1)]),s("td",null,[m(u(t.address)+" ",1),Y,m(" ເບີໂທ: "+u(t.tel),1)]),s("td",null,u(t.user_name),1),s("td",Z,[t.status=="active"?(a(),i("span",$,"ໃຊ້ຢູ່")):(a(),i("span",ss,"ປິດ"))]),s("td",es,[s("div",ts,[os,s("div",ls,[s("a",{class:"dropdown-item",href:"javascript:void(0);",onClick:v=>d.EditUser(t.id)},[is,m(" ແກ້ໄຂ")],8,rs),s("a",{class:"dropdown-item",href:"javascript:void(0);",onClick:v=>d.DeleteUser(t.id)},[ns,m(" ລຶບ")],8,as)])])])]))),128))])):(a(),i("tbody",ds,ms))]),k(g,{pagination:l.UserData,onPaginate:e[6]||(e[6]=t=>d.GetUser(t)),offset:4},null,8,["pagination"])])])]),s("div",_s,[s("div",us,[s("form",hs,[s("div",ps,[s("button",fs,null,512)]),s("div",bs,[s("div",gs,[s("div",vs,[s("div",Us,[s("div",ys,[s("img",{src:l.user_img_pre,onClick:e[7]||(e[7]=t=>r.$refs.user_img.click()),class:"rounded-circle av-p cursor-pointer",alt:"",srcset:""},null,8,ws),s("div",Fs,[l.UserForm.image?(a(),i("label",{key:0,class:"btn btn-icon btn-danger rounded-circle",onClick:e[8]||(e[8]=t=>d.rmimg()),style:{width:"40px",height:"40px"}},xs)):p("",!0),s("input",{type:"file",ref:"user_img",onChange:e[9]||(e[9]=t=>d.onSelectImage(t)),class:"d-none"},null,544)])])])])]),s("div",Ss,[s("div",Ds,[Vs,n(s("input",{class:"form-control",type:"text","onUpdate:modelValue":e[10]||(e[10]=t=>l.UserForm.name=t),id:"f-name",placeholder:"..."},null,512),[[c,l.UserForm.name]])]),s("div",Cs,[js,n(s("input",{class:"form-control",type:"text","onUpdate:modelValue":e[11]||(e[11]=t=>l.UserForm.last_name=t),id:"f-lastname",placeholder:"..."},null,512),[[c,l.UserForm.last_name]])])]),s("div",Gs,[s("div",Is,[Es,s("div",Ms,[s("div",Ps,[n(s("input",{name:"gender","onUpdate:modelValue":e[12]||(e[12]=t=>l.UserForm.gender=t),class:"form-check-input",type:"radio",value:"male",id:"male"},null,512),[[b,l.UserForm.gender]]),Bs]),s("div",Ts,[n(s("input",{name:"gender","onUpdate:modelValue":e[13]||(e[13]=t=>l.UserForm.gender=t),class:"form-check-input",type:"radio",value:"female",id:"female"},null,512),[[b,l.UserForm.gender]]),As])])]),s("div",Ls,[Ns,n(s("select",{id:"st","onUpdate:modelValue":e[14]||(e[14]=t=>l.UserForm.staff_type=t),class:"form-select"},qs,512),[[h,l.UserForm.staff_type]])])]),l.UserForm.staff_type=="user"?(a(),i("div",zs,[s("div",Hs,[Js,n(s("input",{type:"text","onUpdate:modelValue":e[15]||(e[15]=t=>l.UserForm.user_name=t),id:"user-name",class:"form-control",placeholder:"..."},null,512),[[c,l.UserForm.user_name]])]),s("div",Os,[Qs,n(s("input",{type:"password","onUpdate:modelValue":e[16]||(e[16]=t=>l.UserForm.password=t),id:"user-pass",class:"form-control",placeholder:"..."},null,512),[[c,l.UserForm.password]])])])):p("",!0),s("div",Ws,[s("div",Xs,[Ys,n(s("input",{type:"text","onUpdate:modelValue":e[17]||(e[17]=t=>l.UserForm.tel=t),id:"tel",class:"form-control",placeholder:"..."},null,512),[[c,l.UserForm.tel]])]),s("div",Zs,[$s,n(s("input",{type:"text","onUpdate:modelValue":e[18]||(e[18]=t=>l.UserForm.address=t),id:"address",class:"form-control",placeholder:"..."},null,512),[[c,l.UserForm.address]])])]),s("div",se,[s("div",ee,[te,n(s("select",{id:"st","onUpdate:modelValue":e[19]||(e[19]=t=>l.UserForm.roles=t),class:"form-select"},re,512),[[h,l.UserForm.roles]])]),s("div",ie,[ae,n(s("select",{id:"st","onUpdate:modelValue":e[20]||(e[20]=t=>l.UserForm.status=t),class:"form-select"},ce,512),[[h,l.UserForm.status]])])]),s("div",me,[s("button",{type:"button",class:"btn btn-primary me-2",disabled:d.check_bt,onClick:e[21]||(e[21]=t=>d.SaveUser())},[r.loading_post?(a(),i("div",he,fe)):(a(),i("span",ue,"ບັນທຶກ"))],8,_e),be])])])])])],64)}const we=y(V,[["render",ge],["__scopeId","data-v-298cd649"]]);export{we as default};
