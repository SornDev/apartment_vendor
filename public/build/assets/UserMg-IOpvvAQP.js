import{m as w}from"./ulmixins-3GuYya29.js";import{_ as k,u as F,c as i,a as s,w as a,m as f,h as _,j as x,f as m,F as g,r as b,e as S,v,g as C,o as n,b as u,t as p,p as D,q as E}from"./app-R5zms-zh.js";const V={name:"DmsUserMg",setup(){return{store:F()}},mixins:[w],data(){return{url:window.location.origin,user_img_pre:window.location.origin+"/assets/img/no-img.jpeg",UserData:{data:[]},RolesData:[],UserForm:{name:"",last_name:"",gender:"male",staff_type:"user",user_name:"",password:"",image:"",tel:"",address:"",roles:"",status:"active"}}},computed:{check_bt(){return this.UserForm.name==""||this.UserForm.last_name==""||this.UserForm.tel==""||this.UserForm.address==""||this.UserForm.staff_type=="user"&&this.UserForm.user_name==""||this.UserForm.staff_type=="user"&&this.UserForm.password==""?!0:!!this.loading_post}},mounted(){},methods:{ChangeSort(){this.Sort=="asc"?this.Sort="desc":this.Sort="asc",this.GetUser()},rmimg(){this.UserForm.image="",this.user_img_pre=this.url+"/assets/img/no-img.jpeg"},onSelectImage(l){var e=l.target.files[0];if(e){this.UserForm.image=e;var h=new FileReader;h.onloadend=()=>{e.type.includes("image")?this.user_img_pre=h.result:e.type.includes("word")?this.user_img_pre=this.url+"/assets/img/word.png":e.type.includes("pdf")?this.user_img_pre=this.url+"/assets/img/pdf.png":this.user_img_pre=this.url+"/assets/img/document.png"},h.readAsDataURL(e)}},AddUser(){this.FormType=!0,this.UserForm={name:"",last_name:"",gender:"male",staff_type:"user",user_name:"",password:"",image:"",tel:"",address:"",roles:"",status:"active"};var l=new bootstrap.Modal(document.getElementById("user-form"),{keyboard:!1});l.show()},SaveUser(){this.FormType?this.AddData("user/add",this.UserForm,l=>{l.success&&(this.$refs.close_use_form.click(),this.GetUser())}):this.UpdateData("user/update/"+this.EditID,this.UserForm,l=>{l.success&&(this.$refs.close_use_form.click(),this.GetUser())})},EditUser(l){this.FormType=!1,this.EditData("user/edit",l,e=>{if(e.success){this.EditID=l,this.UserForm=e.user,e.user.image?this.user_img_pre=this.url+"/assets/img/"+e.user.image:this.user_img_pre=this.url+"/assets/img/no-img.jpeg";var h=new bootstrap.Modal(document.getElementById("user-form"),{keyboard:!1});h.show()}})},DeleteUser(l){this.DeleteData("user/delete",l,e=>{e.success&&this.GetUser()})},GetUser(l){this.GetData(`user/get?page=${l}&perpage=${this.PerPage}&sort=${this.Sort}&search=${this.Search}`,e=>{this.UserData=e.user,this.RolesData=e.roles})}},created(){this.GetUser()},watch:{Search:function(l){l==""&&this.GetUser()}}},o=l=>(D("data-v-91cbe889"),l=l(),E(),l),I={class:"card"},R=o(()=>s("h5",{class:"card-header"},"ຈັດການຜູ້ໃຊ້",-1)),j={class:"card-body"},A={class:"table-responsive text-nowrap"},G={class:"d-flex justify-content-between mb-2"},T={class:"d-flex justify-content-between align-items-center"},N={key:0,class:"bx bx-sort-up fs-4 me-2"},L={key:1,class:"bx bx-sort-down fs-4 me-2"},M=o(()=>s("option",{value:"10"},"10",-1)),P=o(()=>s("option",{value:"20"},"20",-1)),B=o(()=>s("option",{value:"30"},"30",-1)),J=[M,P,B],O={class:"d-flex"},K={class:"table table-bordered"},q={class:"table-info"},z=o(()=>s("th",{class:"fs-6 fw-bold",width:"40"},null,-1)),H=o(()=>s("th",{class:"fs-6 fw-bold"},"ຊື່ ແລະ ນາມສະກຸນ",-1)),Q=o(()=>s("th",{class:"fs-6 fw-bold"},"ທີ່ຢູ່ / ຕິດຕໍ່",-1)),W=o(()=>s("th",{class:"fs-6 fw-bold"},"ຊື່ຜູ້ໃຊ້",-1)),X=o(()=>s("th",{class:"fs-6 fw-bold",width:"110"},"ສະຖານະ",-1)),Y={key:0,class:"fs-6 fw-bold",width:"100"},Z={key:0},$={key:0},ss=o(()=>s("td",{colspan:"6",class:"text-center"},[s("div",{class:"spinner-border text-warning",role:"status"},[s("span",{class:"visually-hidden"},"Loading...")])],-1)),es=[ss],ts=["src"],os=["src"],rs={key:0},ls=o(()=>s("br",null,null,-1)),is={class:"text-center"},ns={key:0,class:"badge bg-label-success"},as={key:1,class:"badge bg-label-danger"},ds={key:0,class:"text-center"},cs={class:"dropdown"},ms=o(()=>s("button",{type:"button",class:"btn p-0 dropdown-toggle hide-arrow","data-bs-toggle":"dropdown"},[s("i",{class:"bx bx-dots-vertical-rounded"})],-1)),_s={class:"dropdown-menu"},us=["onClick"],hs=o(()=>s("i",{class:"bx bx-edit-alt me-1"},null,-1)),ps=["onClick"],fs=o(()=>s("i",{class:"bx bx-trash me-1"},null,-1)),gs={key:1},bs=o(()=>s("tr",null,[s("td",{colspan:"6",class:"text-center"},[s("i",{class:"bx bxs-data me-1"}),u(" ບໍ່ມີຂໍ້ມູນ ")])],-1)),vs=[bs],Us={class:"modal modal-top modal-md fade","data-bs-backdrop":"static",id:"user-form",tabindex:"-1",style:{display:"none"},"aria-hidden":"true"},ys={class:"modal-dialog"},ws={class:"modal-content"},ks={class:"modal-header"},Fs={type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",ref:"close_use_form"},xs={class:"modal-body pt-0"},Ss={class:"row"},Cs={class:"col-12 mb-3"},Ds={class:"d-flex justify-content-center"},Es={class:"position-relative"},Vs=["src"],Is={class:"position-absolute top-0 end-0"},Rs=o(()=>s("i",{class:"bx bx-x fs-4"},null,-1)),js=[Rs],As={class:"row mb-2"},Gs={class:"col-md-6"},Ts=o(()=>s("label",{for:"f-name",class:"fs-6"},"ຊື່:",-1)),Ns={class:"col-md-6"},Ls=o(()=>s("label",{for:"f-lastname",class:"fs-6"},"ນາມສະກຸນ:",-1)),Ms={class:"row mb-2"},Ps={class:"col-md-6"},Bs=o(()=>s("label",{for:"",class:"fs-6 me-2 mb-2"},"ເພດ:",-1)),Js={class:"d-flex align-items-center"},Os={class:"form-check me-2"},Ks=o(()=>s("label",{class:"form-check-label",for:"male"}," ຊາຍ ",-1)),qs={class:"form-check me-2"},zs=o(()=>s("label",{class:"form-check-label",for:"female"}," ຍິງ ",-1)),Hs={class:"col-md-6"},Qs=o(()=>s("label",{for:"st",class:"form-label fs-6"},"ປະເພດຜູ້ໃຊ້:",-1)),Ws=o(()=>s("option",{value:"staff"},"ພະນັກງານ",-1)),Xs=o(()=>s("option",{value:"user"},"ພະນັກງານ ແລະ ຜູ້ໃຊ້ງານ",-1)),Ys=[Ws,Xs],Zs={key:0,class:"row mb-2"},$s={class:"col-md-6"},se=o(()=>s("label",{for:"user-name",class:"form-label fs-6"},"ຊື່ຜູ້ໃຊ້:",-1)),ee={class:"col-md-6"},te=o(()=>s("label",{for:"user-pass",class:"form-label fs-6"},"ລະຫັດຜ່ານ:",-1)),oe={class:"row mb-2"},re={class:"col-md-6"},le=o(()=>s("label",{for:"tel",class:"form-label fs-6"},"ເບີໂທ:",-1)),ie={class:"col-md-6"},ne=o(()=>s("label",{for:"address",class:"form-label fs-6"},"ທີ່ຢູ່:",-1)),ae={class:"row mb-2"},de={class:"col-md-6"},ce=o(()=>s("label",{for:"rolse",class:"form-label fs-6"},"ສິດຜູ້ໃຊ້:",-1)),me=["value"],_e={class:"col-md-6"},ue=o(()=>s("label",{for:"status",class:"form-label fs-6"},"ສະຖານະ:",-1)),he=o(()=>s("option",{value:"active"},"ໃຊ້ງານຢູ່",-1)),pe=o(()=>s("option",{value:"disable"},"ປິດ",-1)),fe=[he,pe],ge={class:"d-flex justify-content-end mt-4"},be=["disabled"],ve={key:0},Ue={key:1,class:"spinner-border text-warning",role:"status"},ye=o(()=>s("span",{class:"visually-hidden"},"Loading...",-1)),we=[ye],ke=o(()=>s("button",{type:"button",class:"btn btn-label-secondary","data-bs-dismiss":"modal"},"ຍົກເລີກ",-1));function Fe(l,e,h,d,r,c){const U=C("pagination");return n(),i(g,null,[s("div",I,[R,s("div",j,[s("div",A,[s("div",G,[s("div",T,[s("div",{class:"cursor-pointer",onClick:e[0]||(e[0]=t=>c.ChangeSort())},[l.Sort=="asc"?(n(),i("i",N)):(n(),i("i",L))]),a(s("select",{class:"form-select me-2","onUpdate:modelValue":e[1]||(e[1]=t=>l.PerPage=t),onChange:e[2]||(e[2]=t=>c.GetUser())},J,544),[[f,l.PerPage]])]),s("div",O,[a(s("input",{type:"text",class:"form-control me-2","onUpdate:modelValue":e[3]||(e[3]=t=>l.Search=t),onKeyup:e[4]||(e[4]=x(t=>c.GetUser(),["enter"])),placeholder:"ຄົ້ນຫາ..."},null,544),[[_,l.Search]]),d.store.get_permissions.includes("USER_ACC_EDIT")||JSON.parse(d.store.get_user).user_type=="admin"?(n(),i("button",{key:0,class:"btn btn-primary",onClick:e[5]||(e[5]=t=>c.AddUser())},"ເພີ່ມໃໝ່")):m("",!0)])]),s("table",K,[s("thead",null,[s("tr",q,[z,H,Q,W,X,d.store.get_permissions.includes("USER_ACC_EDIT")||d.store.get_permissions.includes("USER_ACC_DEL")||JSON.parse(d.store.get_user).user_type=="admin"?(n(),i("th",Y,"ຈັດການ")):m("",!0)])]),r.UserData.data.length>0?(n(),i("tbody",Z,[l.loading_table?(n(),i("tr",$,es)):(n(!0),i(g,{key:1},b(r.UserData.data,t=>(n(),i("tr",{key:t.id},[s("td",null,[t.image?(n(),i("img",{key:0,src:r.url+"/assets/img/"+t.image,class:"rounded-circle avatar imc"},null,8,ts)):(n(),i("img",{key:1,src:r.url+"/assets/img/no-img.jpeg",class:"rounded-circle avatar imc"},null,8,os))]),s("td",null,[u(" ທ່ານ "),t.gender=="female"?(n(),i("span",rs,"ນ")):m("",!0),u(" "+p(t.name)+" "+p(t.last_name),1)]),s("td",null,[u(p(t.address)+" ",1),ls,u(" ເບີໂທ: "+p(t.tel),1)]),s("td",null,p(t.user_name),1),s("td",is,[t.status=="active"?(n(),i("span",ns,"ໃຊ້ຢູ່")):(n(),i("span",as,"ປິດ"))]),d.store.get_permissions.includes("USER_ACC_EDIT")||d.store.get_permissions.includes("USER_ACC_DEL")?(n(),i("td",ds,[s("div",cs,[ms,s("div",_s,[d.store.get_permissions.includes("USER_ACC_EDIT")||JSON.parse(d.store.get_user).user_type=="admin"?(n(),i("a",{key:0,class:"dropdown-item",href:"javascript:void(0);",onClick:y=>c.EditUser(t.id)},[hs,u(" ແກ້ໄຂ")],8,us)):m("",!0),d.store.get_permissions.includes("USER_ACC_DEL")||JSON.parse(d.store.get_user).user_type=="admin"?(n(),i("a",{key:1,class:"dropdown-item",href:"javascript:void(0);",onClick:y=>c.DeleteUser(t.id)},[fs,u(" ລຶບ")],8,ps)):m("",!0)])])])):m("",!0)]))),128))])):(n(),i("tbody",gs,vs))]),S(U,{pagination:r.UserData,onPaginate:e[6]||(e[6]=t=>c.GetUser(t)),offset:4},null,8,["pagination"])])])]),s("div",Us,[s("div",ys,[s("form",ws,[s("div",ks,[s("button",Fs,null,512)]),s("div",xs,[s("div",Ss,[s("div",Cs,[s("div",Ds,[s("div",Es,[s("img",{src:r.user_img_pre,onClick:e[7]||(e[7]=t=>l.$refs.user_img.click()),class:"rounded-circle av-p cursor-pointer",alt:"",srcset:""},null,8,Vs),s("div",Is,[r.UserForm.image?(n(),i("label",{key:0,class:"btn btn-icon btn-danger rounded-circle",onClick:e[8]||(e[8]=t=>c.rmimg()),style:{width:"40px",height:"40px"}},js)):m("",!0),s("input",{type:"file",ref:"user_img",onChange:e[9]||(e[9]=t=>c.onSelectImage(t)),class:"d-none"},null,544)])])])])]),s("div",As,[s("div",Gs,[Ts,a(s("input",{class:"form-control",type:"text","onUpdate:modelValue":e[10]||(e[10]=t=>r.UserForm.name=t),id:"f-name",placeholder:"..."},null,512),[[_,r.UserForm.name]])]),s("div",Ns,[Ls,a(s("input",{class:"form-control",type:"text","onUpdate:modelValue":e[11]||(e[11]=t=>r.UserForm.last_name=t),id:"f-lastname",placeholder:"..."},null,512),[[_,r.UserForm.last_name]])])]),s("div",Ms,[s("div",Ps,[Bs,s("div",Js,[s("div",Os,[a(s("input",{name:"gender","onUpdate:modelValue":e[12]||(e[12]=t=>r.UserForm.gender=t),class:"form-check-input",type:"radio",value:"male",id:"male"},null,512),[[v,r.UserForm.gender]]),Ks]),s("div",qs,[a(s("input",{name:"gender","onUpdate:modelValue":e[13]||(e[13]=t=>r.UserForm.gender=t),class:"form-check-input",type:"radio",value:"female",id:"female"},null,512),[[v,r.UserForm.gender]]),zs])])]),s("div",Hs,[Qs,a(s("select",{id:"st","onUpdate:modelValue":e[14]||(e[14]=t=>r.UserForm.staff_type=t),class:"form-select"},Ys,512),[[f,r.UserForm.staff_type]])])]),r.UserForm.staff_type=="user"?(n(),i("div",Zs,[s("div",$s,[se,a(s("input",{type:"text","onUpdate:modelValue":e[15]||(e[15]=t=>r.UserForm.user_name=t),id:"user-name",class:"form-control",placeholder:"..."},null,512),[[_,r.UserForm.user_name]])]),s("div",ee,[te,a(s("input",{type:"password","onUpdate:modelValue":e[16]||(e[16]=t=>r.UserForm.password=t),id:"user-pass",class:"form-control",placeholder:"..."},null,512),[[_,r.UserForm.password]])])])):m("",!0),s("div",oe,[s("div",re,[le,a(s("input",{type:"text","onUpdate:modelValue":e[17]||(e[17]=t=>r.UserForm.tel=t),id:"tel",class:"form-control",placeholder:"..."},null,512),[[_,r.UserForm.tel]])]),s("div",ie,[ne,a(s("input",{type:"text","onUpdate:modelValue":e[18]||(e[18]=t=>r.UserForm.address=t),id:"address",class:"form-control",placeholder:"..."},null,512),[[_,r.UserForm.address]])])]),s("div",ae,[s("div",de,[ce,a(s("select",{id:"st","onUpdate:modelValue":e[19]||(e[19]=t=>r.UserForm.roles=t),class:"form-select"},[(n(!0),i(g,null,b(r.RolesData,t=>(n(),i("option",{value:t.id,key:t.id},p(t.role_name),9,me))),128))],512),[[f,r.UserForm.roles]])]),s("div",_e,[ue,a(s("select",{id:"st","onUpdate:modelValue":e[20]||(e[20]=t=>r.UserForm.status=t),class:"form-select"},fe,512),[[f,r.UserForm.status]])])]),s("div",ge,[s("button",{type:"button",class:"btn btn-primary me-2",disabled:c.check_bt,onClick:e[21]||(e[21]=t=>c.SaveUser())},[l.loading_post?(n(),i("div",Ue,we)):(n(),i("span",ve,"ບັນທຶກ"))],8,be),ke])])])])])],64)}const Ce=k(V,[["render",Fe],["__scopeId","data-v-91cbe889"]]);export{Ce as default};
